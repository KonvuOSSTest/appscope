jobs:
  - job: ${{ parameters.name }}_test
    displayName: Run ${{ parameters.name }} tests
    pool:
      vmImage: 'ubuntu-16.04'
    steps:
      - script: docker-compose -f docker-compose.yml -f azure/docker-compose.override.azure.yml run ${{ parameters.containerName }}
        workingDirectory: ./test/testContainers/
      - task: CopyFiles@2
        condition: always()
        inputs:
          contents: test/testContainers/logs/**
          targetFolder: $(Build.ArtifactStagingDirectory)
      - task: PublishBuildArtifacts@1
        inputs:
          pathToPublish: $(Build.ArtifactStagingDirectory)
          artifactName: ${{ parameters.name }}ITOut